{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var _t = function t(r, e) {\n    return (_t = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (t, r) {\n      t.__proto__ = r;\n    } || function (t, r) {\n      for (var e in r) {\n        r.hasOwnProperty(e) && (t[e] = r[e]);\n      }\n    })(r, e);\n  };\n\n  return function (r, e) {\n    function n() {\n      this.constructor = r;\n    }\n\n    _t(r, e), r.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: !0\n});\n\nvar TableObject_1 = require(\"./TableObject\"),\n    StringUtils_1 = require(\"../utils/StringUtils\"),\n    ArrayUtils_1 = require(\"../utils/ArrayUtils\"),\n    CSVObject = function (t) {\n  function r(r, e, n, i) {\n    void 0 === r && (r = \"\"), void 0 === e && (e = !1), void 0 === n && (n = \",\"), void 0 === i && (i = '\"');\n    var s = t.call(this) || this;\n    if (s._hasHeaders = !1, !StringUtils_1.StringUtils.isString(r)) throw new Error(\"constructor expects a string value\");\n    if (StringUtils_1.StringUtils.isEmpty(r)) return s;\n\n    for (var o = 0, l = 0, u = !1, a = \"\", c = r.length, h = 0; h < c; h++) {\n      var f = r.charAt(h);\n      f !== n || u ? f !== i ? \"\\r\" !== f && \"\\n\" !== f ? a += f : (u ? a += f : l > 0 && (s._insertField(o, l, a), o++, a = \"\", l = 0), \"\\r\" === f && \"\\n\" === r.substr(h + 1, 1) && (u && (a += \"\\n\"), h++)) : u && r.substr(h + 1, 1) === i ? (a += f, h++) : (u = !u) ? a = \"\" : h = s._findNextDelimiterIndex(r, h, n, c) - 1 : (s._insertField(o, l, a), a = \"\", l++);\n    }\n\n    return (\"\" != a || l >= s._columnsCount) && s._insertField(o, l, a), e && s._defineHeaders(), s;\n  }\n\n  return __extends(r, t), r.prototype.getCell = function (r, e) {\n    var n = t.prototype.getCell.call(this, r, e);\n    return null === n ? \"\" : n;\n  }, r.prototype.setCell = function (r, e, n) {\n    if (!StringUtils_1.StringUtils.isString(n)) throw new Error(\"value must be a string\");\n    return t.prototype.setCell.call(this, r, e, n);\n  }, r.isCSV = function (t) {\n    try {\n      return new r(t).countCells() >= 0;\n    } catch (e) {\n      try {\n        return null !== t && t instanceof r;\n      } catch (t) {\n        return !1;\n      }\n    }\n  }, r.prototype.isEqualTo = function (t) {\n    var e = null;\n\n    try {\n      e = new r(t, this._hasHeaders);\n    } catch (n) {\n      try {\n        t instanceof r && (e = t);\n      } catch (t) {}\n    }\n\n    if (null == e) throw new Error(\"csv does not contain valid csv data\");\n    var n = this.countRows(),\n        i = this.countColumns();\n    if (0 === this.countCells() && 0 === e.countCells()) return !0;\n    if (this._hasHeaders && !ArrayUtils_1.ArrayUtils.isEqualTo(this.getColumnNames(), e.getColumnNames())) return !1;\n    if (n !== e.countRows() || i !== e.countColumns()) return !1;\n\n    for (var s = 0; s < n; s++) {\n      for (var o = 0; o < i; o++) {\n        var l = this.getCell(s, o);\n        null === l && (l = \"\");\n        var u = e.getCell(s, o);\n        if (null === u && (u = \"\"), l !== u) return !1;\n      }\n    }\n\n    return !0;\n  }, r.prototype.toString = function (t, r) {\n    void 0 === t && (t = \",\"), void 0 === r && (r = '\"');\n    var e = \"\";\n\n    if (this._hasHeaders) {\n      for (var n = [], i = 0, s = this.getColumnNames(); i < s.length; i++) {\n        var o = s[i];\n        n.push(this._escapeField(o, t, r));\n      }\n\n      e += n.join(t) + \"\\r\\n\";\n    }\n\n    for (var l = this.countRows(), u = this.countColumns(), a = 0; a < l; a++) {\n      n = [];\n\n      for (var c = 0; c < u; c++) {\n        var h = \"\";\n\n        try {\n          h = this._escapeField(this._cells.get(a + \"-\" + c), t, r);\n        } catch (t) {}\n\n        n.push(h);\n      }\n\n      e += n.join(t) + \"\\r\\n\";\n    }\n\n    return l > 0 ? e.substring(0, e.length - 2) : e;\n  }, r.prototype._insertField = function (t, r, e) {\n    t >= this._rowsCount && this._rowsCount++, r >= this._columnsCount && this._columnsCount++, this._cells.set(t + \"-\" + r, e);\n  }, r.prototype._escapeField = function (t, r, e) {\n    return (t.indexOf(\"\\r\") >= 0 || t.indexOf(\"\\n\") >= 0 || t.indexOf(e) >= 0 || t.indexOf(r) >= 0) && (t = e + (t = StringUtils_1.StringUtils.replace(t, [e], [e + e])) + e), t;\n  }, r.prototype._findNextDelimiterIndex = function (t, r, e, n) {\n    for (var i = r + 1; i < n; i++) {\n      var s = t.charAt(i);\n      if (s === e || \"\\r\" === s || \"\\n\" === s) return i;\n    }\n\n    return n;\n  }, r.prototype._defineHeaders = function () {\n    var t = this.getRow(0);\n\n    if (ArrayUtils_1.ArrayUtils.hasDuplicateElements(t)) {\n      for (var r = 0, e = [], n = ArrayUtils_1.ArrayUtils.getDuplicateElements(t), i = 0, s = t; i < s.length; i++) {\n        var o = s[i];\n        if (null === o || \"\" === o) o = \"(\" + ++r + \")\";else for (var l = 0, u = n; l < u.length; l++) {\n          if (o === u[l]) {\n            o = o + \"(\" + ++r + \")\";\n            break;\n          }\n        }\n        e.push(o);\n      }\n\n      this.setColumnNames(e);\n    } else this.setColumnNames(t);\n\n    this.removeRow(0), this._hasHeaders = !0;\n  }, r;\n}(TableObject_1.TableObject);\n\nexports.CSVObject = CSVObject;","map":{"version":3,"sources":["/Users/stefan_rmmr/software_dev/beat_inspector/st_audiorec/frontend/node_modules/turbocommons-ts/model/CSVObject.js"],"names":["__extends","t","r","e","Object","setPrototypeOf","__proto__","Array","hasOwnProperty","n","constructor","prototype","create","defineProperty","exports","value","TableObject_1","require","StringUtils_1","ArrayUtils_1","CSVObject","i","s","call","_hasHeaders","StringUtils","isString","Error","isEmpty","o","l","u","a","c","length","h","f","charAt","_insertField","substr","_findNextDelimiterIndex","_columnsCount","_defineHeaders","getCell","setCell","isCSV","countCells","isEqualTo","countRows","countColumns","ArrayUtils","getColumnNames","toString","push","_escapeField","join","_cells","get","substring","_rowsCount","set","indexOf","replace","getRow","hasDuplicateElements","getDuplicateElements","setColumnNames","removeRow","TableObject"],"mappings":"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","sourcesContent":["\"use strict\";var __extends=this&&this.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(exports,\"__esModule\",{value:!0});var TableObject_1=require(\"./TableObject\"),StringUtils_1=require(\"../utils/StringUtils\"),ArrayUtils_1=require(\"../utils/ArrayUtils\"),CSVObject=function(t){function r(r,e,n,i){void 0===r&&(r=\"\"),void 0===e&&(e=!1),void 0===n&&(n=\",\"),void 0===i&&(i='\"');var s=t.call(this)||this;if(s._hasHeaders=!1,!StringUtils_1.StringUtils.isString(r))throw new Error(\"constructor expects a string value\");if(StringUtils_1.StringUtils.isEmpty(r))return s;for(var o=0,l=0,u=!1,a=\"\",c=r.length,h=0;h<c;h++){var f=r.charAt(h);f!==n||u?f!==i?\"\\r\"!==f&&\"\\n\"!==f?a+=f:(u?a+=f:l>0&&(s._insertField(o,l,a),o++,a=\"\",l=0),\"\\r\"===f&&\"\\n\"===r.substr(h+1,1)&&(u&&(a+=\"\\n\"),h++)):u&&r.substr(h+1,1)===i?(a+=f,h++):(u=!u)?a=\"\":h=s._findNextDelimiterIndex(r,h,n,c)-1:(s._insertField(o,l,a),a=\"\",l++)}return(\"\"!=a||l>=s._columnsCount)&&s._insertField(o,l,a),e&&s._defineHeaders(),s}return __extends(r,t),r.prototype.getCell=function(r,e){var n=t.prototype.getCell.call(this,r,e);return null===n?\"\":n},r.prototype.setCell=function(r,e,n){if(!StringUtils_1.StringUtils.isString(n))throw new Error(\"value must be a string\");return t.prototype.setCell.call(this,r,e,n)},r.isCSV=function(t){try{return new r(t).countCells()>=0}catch(e){try{return null!==t&&t instanceof r}catch(t){return!1}}},r.prototype.isEqualTo=function(t){var e=null;try{e=new r(t,this._hasHeaders)}catch(n){try{t instanceof r&&(e=t)}catch(t){}}if(null==e)throw new Error(\"csv does not contain valid csv data\");var n=this.countRows(),i=this.countColumns();if(0===this.countCells()&&0===e.countCells())return!0;if(this._hasHeaders&&!ArrayUtils_1.ArrayUtils.isEqualTo(this.getColumnNames(),e.getColumnNames()))return!1;if(n!==e.countRows()||i!==e.countColumns())return!1;for(var s=0;s<n;s++)for(var o=0;o<i;o++){var l=this.getCell(s,o);null===l&&(l=\"\");var u=e.getCell(s,o);if(null===u&&(u=\"\"),l!==u)return!1}return!0},r.prototype.toString=function(t,r){void 0===t&&(t=\",\"),void 0===r&&(r='\"');var e=\"\";if(this._hasHeaders){for(var n=[],i=0,s=this.getColumnNames();i<s.length;i++){var o=s[i];n.push(this._escapeField(o,t,r))}e+=n.join(t)+\"\\r\\n\"}for(var l=this.countRows(),u=this.countColumns(),a=0;a<l;a++){n=[];for(var c=0;c<u;c++){var h=\"\";try{h=this._escapeField(this._cells.get(a+\"-\"+c),t,r)}catch(t){}n.push(h)}e+=n.join(t)+\"\\r\\n\"}return l>0?e.substring(0,e.length-2):e},r.prototype._insertField=function(t,r,e){t>=this._rowsCount&&this._rowsCount++,r>=this._columnsCount&&this._columnsCount++,this._cells.set(t+\"-\"+r,e)},r.prototype._escapeField=function(t,r,e){return(t.indexOf(\"\\r\")>=0||t.indexOf(\"\\n\")>=0||t.indexOf(e)>=0||t.indexOf(r)>=0)&&(t=e+(t=StringUtils_1.StringUtils.replace(t,[e],[e+e]))+e),t},r.prototype._findNextDelimiterIndex=function(t,r,e,n){for(var i=r+1;i<n;i++){var s=t.charAt(i);if(s===e||\"\\r\"===s||\"\\n\"===s)return i}return n},r.prototype._defineHeaders=function(){var t=this.getRow(0);if(ArrayUtils_1.ArrayUtils.hasDuplicateElements(t)){for(var r=0,e=[],n=ArrayUtils_1.ArrayUtils.getDuplicateElements(t),i=0,s=t;i<s.length;i++){var o=s[i];if(null===o||\"\"===o)o=\"(\"+ ++r+\")\";else for(var l=0,u=n;l<u.length;l++){if(o===u[l]){o=o+\"(\"+ ++r+\")\";break}}e.push(o)}this.setColumnNames(e)}else this.setColumnNames(t);this.removeRow(0),this._hasHeaders=!0},r}(TableObject_1.TableObject);exports.CSVObject=CSVObject;"]},"metadata":{},"sourceType":"script"}