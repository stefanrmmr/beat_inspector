{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: !0\n});\n\nvar turbocommons_ts_1 = require(\"turbocommons-ts\"),\n    FilesManager_1 = require(\"./FilesManager\"),\n    TerminalManager = function () {\n  function r(r, t) {\n    if (void 0 === r && (r = \"\"), void 0 === t && (t = !0), this._linkSystemWorkDir = !0, this.baseCommand = \"\", this.workDirHistory = [], !turbocommons_ts_1.StringUtils.isString(r)) throw new Error(\"workDir must be a string\");\n    this.path = require(\"path\"), this.execSync = require(\"child_process\").execSync, this._linkSystemWorkDir = t, r = \"\" === r ? this.path.resolve(\"./\") : this.path.resolve(r), this.filesManager = new FilesManager_1.FilesManager(r), this._linkSystemWorkDir && process.chdir(r), this.workDirHistory = [r];\n  }\n\n  return r.prototype.setWorkDir = function (r) {\n    if (!this.filesManager.isDirectory(r)) throw new Error(\"Invalid path: \" + r);\n    return r = this.path.resolve(r), this._linkSystemWorkDir && process.chdir(r), this.filesManager = new FilesManager_1.FilesManager(r), this.workDirHistory.push(r), r;\n  }, r.prototype.getWorkDir = function () {\n    return this.workDirHistory[this.workDirHistory.length - 1];\n  }, r.prototype.setPreviousWorkDir = function () {\n    if (this.workDirHistory.length <= 1) throw new Error(\"Requesting previous work dir but none available\");\n    return this._linkSystemWorkDir && process.chdir(this.workDirHistory[this.workDirHistory.length - 1]), this.workDirHistory.pop(), this.getWorkDir();\n  }, r.prototype.setInitialWorkDir = function () {\n    return this.workDirHistory = [this.workDirHistory[0]], this._linkSystemWorkDir && process.chdir(this.workDirHistory[0]), this.workDirHistory[0];\n  }, r.prototype.createTempDirectory = function (r, t, i) {\n    void 0 === t && (t = !0), void 0 === i && (i = !0);\n    var o = this.filesManager.createTempDirectory(r, i);\n    if (\"boolean\" != typeof t) throw new Error(\"setWorkDirToIt must be a boolean value\");\n    return t && this.setWorkDir(o), o;\n  }, r.prototype.exec = function (r, t) {\n    if (void 0 === t && (t = !1), !turbocommons_ts_1.StringUtils.isString(r)) throw new Error(\"command must be a string\");\n    var i = \"\",\n        o = !1,\n        s = turbocommons_ts_1.StringUtils.isEmpty(this.baseCommand) ? r : this.baseCommand + \" \" + r;\n    if (turbocommons_ts_1.StringUtils.isEmpty(s)) throw new Error(\"no command to execute\");\n\n    var e = function e(r) {\n      var t = \"\";\n      return r.stderr && !turbocommons_ts_1.StringUtils.isEmpty(r.stderr.toString()) && (t = r.stderr.toString()), r.stdout && !turbocommons_ts_1.StringUtils.isEmpty(r.stdout.toString()) && (t += \"\\n\\n\" + r.stdout.toString()), turbocommons_ts_1.StringUtils.isEmpty(t) && (t = r.toString()), t;\n    };\n\n    if (t) try {\n      i = this.execSync(s, {\n        stdio: [0, 1, 2]\n      });\n    } catch (r) {\n      o = !0, i = e(r);\n    } else try {\n      i = this.execSync(s, {\n        stdio: \"pipe\"\n      }).toString();\n    } catch (r) {\n      o = !0, i = e(r);\n    }\n    return {\n      failed: o,\n      output: i\n    };\n  }, r;\n}();\n\nexports.TerminalManager = TerminalManager;","map":{"version":3,"sources":["/Users/stefan_rmmr/software_dev/beat_inspector/st_audiorec/frontend/node_modules/turbodepot-node/managers/TerminalManager.js"],"names":["Object","defineProperty","exports","value","turbocommons_ts_1","require","FilesManager_1","TerminalManager","r","t","_linkSystemWorkDir","baseCommand","workDirHistory","StringUtils","isString","Error","path","execSync","resolve","filesManager","FilesManager","process","chdir","prototype","setWorkDir","isDirectory","push","getWorkDir","length","setPreviousWorkDir","pop","setInitialWorkDir","createTempDirectory","i","o","exec","s","isEmpty","e","stderr","toString","stdout","stdio","failed","output"],"mappings":"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","sourcesContent":["\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var turbocommons_ts_1=require(\"turbocommons-ts\"),FilesManager_1=require(\"./FilesManager\"),TerminalManager=function(){function r(r,t){if(void 0===r&&(r=\"\"),void 0===t&&(t=!0),this._linkSystemWorkDir=!0,this.baseCommand=\"\",this.workDirHistory=[],!turbocommons_ts_1.StringUtils.isString(r))throw new Error(\"workDir must be a string\");this.path=require(\"path\"),this.execSync=require(\"child_process\").execSync,this._linkSystemWorkDir=t,r=\"\"===r?this.path.resolve(\"./\"):this.path.resolve(r),this.filesManager=new FilesManager_1.FilesManager(r),this._linkSystemWorkDir&&process.chdir(r),this.workDirHistory=[r]}return r.prototype.setWorkDir=function(r){if(!this.filesManager.isDirectory(r))throw new Error(\"Invalid path: \"+r);return r=this.path.resolve(r),this._linkSystemWorkDir&&process.chdir(r),this.filesManager=new FilesManager_1.FilesManager(r),this.workDirHistory.push(r),r},r.prototype.getWorkDir=function(){return this.workDirHistory[this.workDirHistory.length-1]},r.prototype.setPreviousWorkDir=function(){if(this.workDirHistory.length<=1)throw new Error(\"Requesting previous work dir but none available\");return this._linkSystemWorkDir&&process.chdir(this.workDirHistory[this.workDirHistory.length-1]),this.workDirHistory.pop(),this.getWorkDir()},r.prototype.setInitialWorkDir=function(){return this.workDirHistory=[this.workDirHistory[0]],this._linkSystemWorkDir&&process.chdir(this.workDirHistory[0]),this.workDirHistory[0]},r.prototype.createTempDirectory=function(r,t,i){void 0===t&&(t=!0),void 0===i&&(i=!0);var o=this.filesManager.createTempDirectory(r,i);if(\"boolean\"!=typeof t)throw new Error(\"setWorkDirToIt must be a boolean value\");return t&&this.setWorkDir(o),o},r.prototype.exec=function(r,t){if(void 0===t&&(t=!1),!turbocommons_ts_1.StringUtils.isString(r))throw new Error(\"command must be a string\");var i=\"\",o=!1,s=turbocommons_ts_1.StringUtils.isEmpty(this.baseCommand)?r:this.baseCommand+\" \"+r;if(turbocommons_ts_1.StringUtils.isEmpty(s))throw new Error(\"no command to execute\");var e=function(r){var t=\"\";return r.stderr&&!turbocommons_ts_1.StringUtils.isEmpty(r.stderr.toString())&&(t=r.stderr.toString()),r.stdout&&!turbocommons_ts_1.StringUtils.isEmpty(r.stdout.toString())&&(t+=\"\\n\\n\"+r.stdout.toString()),turbocommons_ts_1.StringUtils.isEmpty(t)&&(t=r.toString()),t};if(t)try{i=this.execSync(s,{stdio:[0,1,2]})}catch(r){o=!0,i=e(r)}else try{i=this.execSync(s,{stdio:\"pipe\"}).toString()}catch(r){o=!0,i=e(r)}return{failed:o,output:i}},r}();exports.TerminalManager=TerminalManager;"]},"metadata":{},"sourceType":"script"}