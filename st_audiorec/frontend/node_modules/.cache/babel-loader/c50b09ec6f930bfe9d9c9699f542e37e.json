{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: !0\n});\n\nvar StringUtils_1 = require(\"../utils/StringUtils\"),\n    ArrayUtils_1 = require(\"../utils/ArrayUtils\"),\n    JavaPropertiesObject_1 = require(\"../model/JavaPropertiesObject\"),\n    LocalizationManager = function () {\n  function t() {\n    this.missingKeyFormat = \"$exception\", this.wildCardsFormat = \"{N}\", this.isBundleMandatory = !1, this._initialized = !1, this._locales = [], this._languages = [], this._activeBundle = \"\", this._activeLocation = \"\", this._definedLocations = [], this._loadedTranslations = {}, this._filesManager = null, this._httpManager = null;\n  }\n\n  return t.prototype.isInitialized = function () {\n    return this._initialized;\n  }, t.prototype.isLocaleLoaded = function (t) {\n    return this._locales.indexOf(t) >= 0;\n  }, t.prototype.isLanguageLoaded = function (t) {\n    if (2 !== t.length) throw new Error(\"language must be a valid 2 digit value\");\n    return this._languages.indexOf(t) >= 0;\n  }, t.prototype.initialize = function (t, i, e, r, a) {\n    var n = this;\n    if (void 0 === r && (r = null), void 0 === a && (a = null), t ? this._httpManager = t : this._filesManager = t, this._locales = [], this._languages = [], this._activeBundle = \"\", this._activeLocation = \"\", this._definedLocations = e, this._loadedTranslations = {}, !ArrayUtils_1.ArrayUtils.isArray(e) || e.length <= 0) throw new Error(\"Locations must be an array of objects\");\n\n    for (var o = 0, l = e; o < l.length; o++) {\n      var s = l[o];\n      if (!s.label || StringUtils_1.StringUtils.isEmpty(s.label) || !s.path || StringUtils_1.StringUtils.isEmpty(s.path) || !s.bundles || !ArrayUtils_1.ArrayUtils.isArray(s.bundles)) throw new Error(\"Invalid locations specified\");\n    }\n\n    this._loadData(i, e.map(function (t) {\n      return {\n        label: t.label,\n        bundles: t.bundles\n      };\n    }), function (t) {\n      n._initialized = !0, null !== r && r(t);\n    }, a);\n  }, t.prototype.loadLocales = function (t, i, e) {\n    if (void 0 === i && (i = null), void 0 === e && (e = null), !this._initialized) throw new Error(\"LocalizationManager not initialized. Call initialize() before loading more locales\");\n\n    this._loadData(t, this._definedLocations.map(function (t) {\n      return {\n        label: t.label,\n        bundles: t.bundles\n      };\n    }), i, e);\n  }, t.prototype.loadBundles = function (t, i, e, r) {\n    if (void 0 === i && (i = \"\"), void 0 === e && (e = null), void 0 === r && (r = null), !ArrayUtils_1.ArrayUtils.isArray(t) || 0 === t.length) throw new Error(\"no bundles specified to load on \" + i + \" location\");\n    if (!this._initialized) throw new Error(\"LocalizationManager not initialized. Call initialize() before loading more bundles to a location\");\n    \"\" === i && (i = this._activeLocation), this._loadData(this._locales, [{\n      label: i,\n      bundles: t\n    }], e, r);\n  }, t.prototype._loadData = function (t, i, e, r) {\n    if (void 0 === e && (e = null), void 0 === r && (r = null), !ArrayUtils_1.ArrayUtils.isArray(t) || t.length <= 0) throw new Error(\"no locales defined\");\n\n    for (var a = [], n = [], o = 0, l = i; o < l.length; o++) {\n      for (var s = l[o], d = 0, h = s.bundles; d < h.length; d++) {\n        for (var u = h[d], c = 0, g = t; c < g.length; c++) {\n          for (var _ = g[c], f = !1, p = 0, y = this._definedLocations; p < y.length; p++) {\n            var v = y[p];\n\n            if (v.label === s.label) {\n              f = !0, n.push({\n                locale: _,\n                bundle: u,\n                location: s.label\n              }), a.push(StringUtils_1.StringUtils.replace(v.path, [\"$locale\", \"$bundle\"], [_, u]));\n              break;\n            }\n          }\n\n          if (!f) throw new Error(\"Undefined location: \" + s.label);\n        }\n      }\n    }\n\n    this._locales = this._locales.concat(t), this._locales = ArrayUtils_1.ArrayUtils.removeDuplicateElements(this._locales), this._languages = this._locales.map(function (t) {\n      return t.substr(0, 2);\n    }), \"\" === this._activeLocation && (this._activeLocation = i[i.length - 1].label), null !== this._filesManager || this._loadDataFromUrls(a, n, e, r);\n  }, t.prototype._loadDataFromUrls = function (t, i, e, r) {\n    var a = this;\n    void 0 === e && (e = null), void 0 === r && (r = null);\n\n    var n = function n(t) {\n      void 0 === t && (t = []), i.length > 0 && (a._activeBundle = i[i.length - 1].bundle), null !== e && e(t);\n    };\n\n    t.length <= 0 ? n() : this._httpManager.execute(t, function (e, r) {\n      for (var o = [], l = 0; l < e.length; l++) {\n        if (e[l].isError) o.push({\n          path: e[l].url,\n          errorMsg: e[l].errorMsg,\n          errorCode: e[l].code\n        });else {\n          var s = i[l].locale,\n              d = i[l].bundle,\n              h = i[l].location,\n              u = StringUtils_1.StringUtils.getPathExtension(t[l]);\n          a._loadedTranslations.hasOwnProperty(h) || (a._loadedTranslations[h] = {}), a._loadedTranslations[h].hasOwnProperty(s) || (a._loadedTranslations[h][s] = {}), a._loadedTranslations[h][s][d] = \"json\" === u ? a.parseJson(e[l].response) : a.parseProperties(e[l].response);\n        }\n      }\n\n      n(o);\n    }, function (t, i) {\n      null !== r && r(t, i);\n    });\n  }, t.prototype.locales = function () {\n    return this._locales;\n  }, t.prototype.languages = function () {\n    return this._languages;\n  }, t.prototype.activeBundle = function () {\n    return this._activeBundle;\n  }, t.prototype.primaryLocale = function () {\n    if (!this._initialized) throw new Error(\"LocalizationManager not initialized\");\n    return this._locales[0];\n  }, t.prototype.primaryLanguage = function () {\n    if (!this._initialized) throw new Error(\"LocalizationManager not initialized\");\n    return this._languages[0];\n  }, t.prototype.setActiveBundle = function (t) {\n    for (var i = 0, e = Object.keys(this._loadedTranslations); i < e.length; i++) {\n      for (var r = e[i], a = 0, n = Object.keys(this._loadedTranslations[r]); a < n.length; a++) {\n        var o = n[a];\n        if (Object.keys(this._loadedTranslations[r][o]).indexOf(t) >= 0) return this._activeBundle = t, void (this._activeLocation = r);\n      }\n    }\n\n    throw new Error(\"Bundle <\" + t + \"> not loaded\");\n  }, t.prototype.setPrimaryLocale = function (t) {\n    if (!StringUtils_1.StringUtils.isString(t)) throw new Error(\"Invalid locale value\");\n    if (!this.isLocaleLoaded(t)) throw new Error(t + \" not loaded\");\n\n    for (var i = [t], e = 0, r = this._locales; e < r.length; e++) {\n      var a = r[e];\n      a !== t && i.push(a);\n    }\n\n    this._locales = i, this._languages = this._locales.map(function (t) {\n      return t.substr(0, 2);\n    });\n  }, t.prototype.setPrimaryLocales = function (t) {\n    if (!ArrayUtils_1.ArrayUtils.isArray(t) || ArrayUtils_1.ArrayUtils.hasDuplicateElements(t) || t.length <= 0) throw new Error(\"locales must be non empty string array with no duplicate elements\");\n\n    for (var i = t.length - 1; i >= 0; i--) {\n      this.setPrimaryLocale(t[i]);\n    }\n  }, t.prototype.setPrimaryLanguage = function (t) {\n    for (var i = 0, e = this._locales; i < e.length; i++) {\n      var r = e[i];\n      if (r.substr(0, 2) === t) return this.setPrimaryLocale(r);\n    }\n\n    throw new Error(t + \" not loaded\");\n  }, t.prototype.setPrimaryLanguages = function (t) {\n    if (!ArrayUtils_1.ArrayUtils.isArray(t) || ArrayUtils_1.ArrayUtils.hasDuplicateElements(t) || t.length <= 0) throw new Error(\"languages must be non empty string array with no duplicate elements\");\n\n    for (var i = t.length - 1; i >= 0; i--) {\n      this.setPrimaryLanguage(t[i]);\n    }\n  }, t.prototype.setLocalesOrder = function (t) {\n    if (!ArrayUtils_1.ArrayUtils.isArray(t)) throw new Error(\"locales must be an array\");\n    if (t.length !== this._locales.length) throw new Error(\"locales must contain all the currently loaded locales\");\n\n    for (var i = 0, e = t; i < e.length; i++) {\n      var r = e[i];\n      if (!this.isLocaleLoaded(r)) throw new Error(r + \" not loaded\");\n    }\n\n    this._locales = t, this._languages = this._locales.map(function (t) {\n      return t.substr(0, 2);\n    });\n  }, t.prototype.get = function (t, i, e, r) {\n    if (void 0 === i && (i = \"\"), void 0 === e && (e = \"\"), void 0 === r && (r = []), !this._initialized) throw new Error(\"LocalizationManager not initialized. Call initialize() before requesting translated texts\");\n\n    if (\"\" === e && (\"\" !== i && i !== this._activeBundle && this.setActiveBundle(i), e = this._activeLocation), \"\" === i) {\n      if (this.isBundleMandatory) throw new Error(\"bundle is mandatory for key \" + t);\n      i = this._activeBundle;\n    }\n\n    if (-1 === Object.keys(this._loadedTranslations).indexOf(e)) throw new Error(\"Location <\" + e + \"> not loaded\");\n\n    for (var a = 0, n = this._locales; a < n.length; a++) {\n      var o = n[a];\n\n      if (Object.keys(this._loadedTranslations[e]).indexOf(o) >= 0) {\n        if (-1 === Object.keys(this._loadedTranslations[e][o]).indexOf(i)) throw new Error(\"Bundle <\" + i + \"> not loaded\");\n\n        if (Object.keys(this._loadedTranslations[e][o][i]).indexOf(t) >= 0) {\n          this._activeBundle = i, this._activeLocation = e;\n\n          for (var l = this._loadedTranslations[e][o][i][t], s = StringUtils_1.StringUtils.isString(r) ? [String(r)] : r, d = 0; d < s.length; d++) {\n            l = StringUtils_1.StringUtils.replace(l, StringUtils_1.StringUtils.replace(this.wildCardsFormat, \"N\", String(d)), s[d]);\n          }\n\n          return l;\n        }\n      }\n    }\n\n    if (this.missingKeyFormat.indexOf(\"$exception\") >= 0) throw new Error(\"key <\" + t + \"> not found on \" + i + \" - \" + e);\n    return this.missingKeyFormat.replace(\"$key\", t);\n  }, t.prototype.getStartCase = function (t, i, e, r) {\n    return void 0 === i && (i = \"\"), void 0 === e && (e = \"\"), void 0 === r && (r = []), StringUtils_1.StringUtils.formatCase(this.get(t, i, e, r), StringUtils_1.StringUtils.FORMAT_START_CASE);\n  }, t.prototype.getAllUpperCase = function (t, i, e, r) {\n    return void 0 === i && (i = \"\"), void 0 === e && (e = \"\"), void 0 === r && (r = []), StringUtils_1.StringUtils.formatCase(this.get(t, i, e, r), StringUtils_1.StringUtils.FORMAT_ALL_UPPER_CASE);\n  }, t.prototype.getAllLowerCase = function (t, i, e, r) {\n    return void 0 === i && (i = \"\"), void 0 === e && (e = \"\"), void 0 === r && (r = []), StringUtils_1.StringUtils.formatCase(this.get(t, i, e, r), StringUtils_1.StringUtils.FORMAT_ALL_LOWER_CASE);\n  }, t.prototype.getFirstUpperRestLower = function (t, i, e, r) {\n    return void 0 === i && (i = \"\"), void 0 === e && (e = \"\"), void 0 === r && (r = []), StringUtils_1.StringUtils.formatCase(this.get(t, i, e, r), StringUtils_1.StringUtils.FORMAT_FIRST_UPPER_REST_LOWER);\n  }, t.prototype.parseJson = function (t) {\n    return JSON.parse(t);\n  }, t.prototype.parseProperties = function (t) {\n    for (var i = {}, e = new JavaPropertiesObject_1.JavaPropertiesObject(t), r = 0, a = e.getKeys(); r < a.length; r++) {\n      var n = a[r];\n      i[n] = e.get(n);\n    }\n\n    return i;\n  }, t;\n}();\n\nexports.LocalizationManager = LocalizationManager;","map":{"version":3,"sources":["/Users/stefan_rmmr/software_dev/beat_inspector/st_audiorec/frontend/node_modules/turbocommons-ts/managers/LocalizationManager.js"],"names":["Object","defineProperty","exports","value","StringUtils_1","require","ArrayUtils_1","JavaPropertiesObject_1","LocalizationManager","t","missingKeyFormat","wildCardsFormat","isBundleMandatory","_initialized","_locales","_languages","_activeBundle","_activeLocation","_definedLocations","_loadedTranslations","_filesManager","_httpManager","prototype","isInitialized","isLocaleLoaded","indexOf","isLanguageLoaded","length","Error","initialize","i","e","r","a","n","ArrayUtils","isArray","o","l","s","label","StringUtils","isEmpty","path","bundles","_loadData","map","loadLocales","loadBundles","d","h","u","c","g","_","f","p","y","v","push","locale","bundle","location","replace","concat","removeDuplicateElements","substr","_loadDataFromUrls","execute","isError","url","errorMsg","errorCode","code","getPathExtension","hasOwnProperty","parseJson","response","parseProperties","locales","languages","activeBundle","primaryLocale","primaryLanguage","setActiveBundle","keys","setPrimaryLocale","isString","setPrimaryLocales","hasDuplicateElements","setPrimaryLanguage","setPrimaryLanguages","setLocalesOrder","get","String","getStartCase","formatCase","FORMAT_START_CASE","getAllUpperCase","FORMAT_ALL_UPPER_CASE","getAllLowerCase","FORMAT_ALL_LOWER_CASE","getFirstUpperRestLower","FORMAT_FIRST_UPPER_REST_LOWER","JSON","parse","JavaPropertiesObject","getKeys"],"mappings":"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","sourcesContent":["\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var StringUtils_1=require(\"../utils/StringUtils\"),ArrayUtils_1=require(\"../utils/ArrayUtils\"),JavaPropertiesObject_1=require(\"../model/JavaPropertiesObject\"),LocalizationManager=function(){function t(){this.missingKeyFormat=\"$exception\",this.wildCardsFormat=\"{N}\",this.isBundleMandatory=!1,this._initialized=!1,this._locales=[],this._languages=[],this._activeBundle=\"\",this._activeLocation=\"\",this._definedLocations=[],this._loadedTranslations={},this._filesManager=null,this._httpManager=null}return t.prototype.isInitialized=function(){return this._initialized},t.prototype.isLocaleLoaded=function(t){return this._locales.indexOf(t)>=0},t.prototype.isLanguageLoaded=function(t){if(2!==t.length)throw new Error(\"language must be a valid 2 digit value\");return this._languages.indexOf(t)>=0},t.prototype.initialize=function(t,i,e,r,a){var n=this;if(void 0===r&&(r=null),void 0===a&&(a=null),t?this._httpManager=t:this._filesManager=t,this._locales=[],this._languages=[],this._activeBundle=\"\",this._activeLocation=\"\",this._definedLocations=e,this._loadedTranslations={},!ArrayUtils_1.ArrayUtils.isArray(e)||e.length<=0)throw new Error(\"Locations must be an array of objects\");for(var o=0,l=e;o<l.length;o++){var s=l[o];if(!s.label||StringUtils_1.StringUtils.isEmpty(s.label)||!s.path||StringUtils_1.StringUtils.isEmpty(s.path)||!s.bundles||!ArrayUtils_1.ArrayUtils.isArray(s.bundles))throw new Error(\"Invalid locations specified\")}this._loadData(i,e.map(function(t){return{label:t.label,bundles:t.bundles}}),function(t){n._initialized=!0,null!==r&&r(t)},a)},t.prototype.loadLocales=function(t,i,e){if(void 0===i&&(i=null),void 0===e&&(e=null),!this._initialized)throw new Error(\"LocalizationManager not initialized. Call initialize() before loading more locales\");this._loadData(t,this._definedLocations.map(function(t){return{label:t.label,bundles:t.bundles}}),i,e)},t.prototype.loadBundles=function(t,i,e,r){if(void 0===i&&(i=\"\"),void 0===e&&(e=null),void 0===r&&(r=null),!ArrayUtils_1.ArrayUtils.isArray(t)||0===t.length)throw new Error(\"no bundles specified to load on \"+i+\" location\");if(!this._initialized)throw new Error(\"LocalizationManager not initialized. Call initialize() before loading more bundles to a location\");\"\"===i&&(i=this._activeLocation),this._loadData(this._locales,[{label:i,bundles:t}],e,r)},t.prototype._loadData=function(t,i,e,r){if(void 0===e&&(e=null),void 0===r&&(r=null),!ArrayUtils_1.ArrayUtils.isArray(t)||t.length<=0)throw new Error(\"no locales defined\");for(var a=[],n=[],o=0,l=i;o<l.length;o++)for(var s=l[o],d=0,h=s.bundles;d<h.length;d++)for(var u=h[d],c=0,g=t;c<g.length;c++){for(var _=g[c],f=!1,p=0,y=this._definedLocations;p<y.length;p++){var v=y[p];if(v.label===s.label){f=!0,n.push({locale:_,bundle:u,location:s.label}),a.push(StringUtils_1.StringUtils.replace(v.path,[\"$locale\",\"$bundle\"],[_,u]));break}}if(!f)throw new Error(\"Undefined location: \"+s.label)}this._locales=this._locales.concat(t),this._locales=ArrayUtils_1.ArrayUtils.removeDuplicateElements(this._locales),this._languages=this._locales.map(function(t){return t.substr(0,2)}),\"\"===this._activeLocation&&(this._activeLocation=i[i.length-1].label),null!==this._filesManager||this._loadDataFromUrls(a,n,e,r)},t.prototype._loadDataFromUrls=function(t,i,e,r){var a=this;void 0===e&&(e=null),void 0===r&&(r=null);var n=function(t){void 0===t&&(t=[]),i.length>0&&(a._activeBundle=i[i.length-1].bundle),null!==e&&e(t)};t.length<=0?n():this._httpManager.execute(t,function(e,r){for(var o=[],l=0;l<e.length;l++)if(e[l].isError)o.push({path:e[l].url,errorMsg:e[l].errorMsg,errorCode:e[l].code});else{var s=i[l].locale,d=i[l].bundle,h=i[l].location,u=StringUtils_1.StringUtils.getPathExtension(t[l]);a._loadedTranslations.hasOwnProperty(h)||(a._loadedTranslations[h]={}),a._loadedTranslations[h].hasOwnProperty(s)||(a._loadedTranslations[h][s]={}),a._loadedTranslations[h][s][d]=\"json\"===u?a.parseJson(e[l].response):a.parseProperties(e[l].response)}n(o)},function(t,i){null!==r&&r(t,i)})},t.prototype.locales=function(){return this._locales},t.prototype.languages=function(){return this._languages},t.prototype.activeBundle=function(){return this._activeBundle},t.prototype.primaryLocale=function(){if(!this._initialized)throw new Error(\"LocalizationManager not initialized\");return this._locales[0]},t.prototype.primaryLanguage=function(){if(!this._initialized)throw new Error(\"LocalizationManager not initialized\");return this._languages[0]},t.prototype.setActiveBundle=function(t){for(var i=0,e=Object.keys(this._loadedTranslations);i<e.length;i++)for(var r=e[i],a=0,n=Object.keys(this._loadedTranslations[r]);a<n.length;a++){var o=n[a];if(Object.keys(this._loadedTranslations[r][o]).indexOf(t)>=0)return this._activeBundle=t,void(this._activeLocation=r)}throw new Error(\"Bundle <\"+t+\"> not loaded\")},t.prototype.setPrimaryLocale=function(t){if(!StringUtils_1.StringUtils.isString(t))throw new Error(\"Invalid locale value\");if(!this.isLocaleLoaded(t))throw new Error(t+\" not loaded\");for(var i=[t],e=0,r=this._locales;e<r.length;e++){var a=r[e];a!==t&&i.push(a)}this._locales=i,this._languages=this._locales.map(function(t){return t.substr(0,2)})},t.prototype.setPrimaryLocales=function(t){if(!ArrayUtils_1.ArrayUtils.isArray(t)||ArrayUtils_1.ArrayUtils.hasDuplicateElements(t)||t.length<=0)throw new Error(\"locales must be non empty string array with no duplicate elements\");for(var i=t.length-1;i>=0;i--)this.setPrimaryLocale(t[i])},t.prototype.setPrimaryLanguage=function(t){for(var i=0,e=this._locales;i<e.length;i++){var r=e[i];if(r.substr(0,2)===t)return this.setPrimaryLocale(r)}throw new Error(t+\" not loaded\")},t.prototype.setPrimaryLanguages=function(t){if(!ArrayUtils_1.ArrayUtils.isArray(t)||ArrayUtils_1.ArrayUtils.hasDuplicateElements(t)||t.length<=0)throw new Error(\"languages must be non empty string array with no duplicate elements\");for(var i=t.length-1;i>=0;i--)this.setPrimaryLanguage(t[i])},t.prototype.setLocalesOrder=function(t){if(!ArrayUtils_1.ArrayUtils.isArray(t))throw new Error(\"locales must be an array\");if(t.length!==this._locales.length)throw new Error(\"locales must contain all the currently loaded locales\");for(var i=0,e=t;i<e.length;i++){var r=e[i];if(!this.isLocaleLoaded(r))throw new Error(r+\" not loaded\")}this._locales=t,this._languages=this._locales.map(function(t){return t.substr(0,2)})},t.prototype.get=function(t,i,e,r){if(void 0===i&&(i=\"\"),void 0===e&&(e=\"\"),void 0===r&&(r=[]),!this._initialized)throw new Error(\"LocalizationManager not initialized. Call initialize() before requesting translated texts\");if(\"\"===e&&(\"\"!==i&&i!==this._activeBundle&&this.setActiveBundle(i),e=this._activeLocation),\"\"===i){if(this.isBundleMandatory)throw new Error(\"bundle is mandatory for key \"+t);i=this._activeBundle}if(-1===Object.keys(this._loadedTranslations).indexOf(e))throw new Error(\"Location <\"+e+\"> not loaded\");for(var a=0,n=this._locales;a<n.length;a++){var o=n[a];if(Object.keys(this._loadedTranslations[e]).indexOf(o)>=0){if(-1===Object.keys(this._loadedTranslations[e][o]).indexOf(i))throw new Error(\"Bundle <\"+i+\"> not loaded\");if(Object.keys(this._loadedTranslations[e][o][i]).indexOf(t)>=0){this._activeBundle=i,this._activeLocation=e;for(var l=this._loadedTranslations[e][o][i][t],s=StringUtils_1.StringUtils.isString(r)?[String(r)]:r,d=0;d<s.length;d++)l=StringUtils_1.StringUtils.replace(l,StringUtils_1.StringUtils.replace(this.wildCardsFormat,\"N\",String(d)),s[d]);return l}}}if(this.missingKeyFormat.indexOf(\"$exception\")>=0)throw new Error(\"key <\"+t+\"> not found on \"+i+\" - \"+e);return this.missingKeyFormat.replace(\"$key\",t)},t.prototype.getStartCase=function(t,i,e,r){return void 0===i&&(i=\"\"),void 0===e&&(e=\"\"),void 0===r&&(r=[]),StringUtils_1.StringUtils.formatCase(this.get(t,i,e,r),StringUtils_1.StringUtils.FORMAT_START_CASE)},t.prototype.getAllUpperCase=function(t,i,e,r){return void 0===i&&(i=\"\"),void 0===e&&(e=\"\"),void 0===r&&(r=[]),StringUtils_1.StringUtils.formatCase(this.get(t,i,e,r),StringUtils_1.StringUtils.FORMAT_ALL_UPPER_CASE)},t.prototype.getAllLowerCase=function(t,i,e,r){return void 0===i&&(i=\"\"),void 0===e&&(e=\"\"),void 0===r&&(r=[]),StringUtils_1.StringUtils.formatCase(this.get(t,i,e,r),StringUtils_1.StringUtils.FORMAT_ALL_LOWER_CASE)},t.prototype.getFirstUpperRestLower=function(t,i,e,r){return void 0===i&&(i=\"\"),void 0===e&&(e=\"\"),void 0===r&&(r=[]),StringUtils_1.StringUtils.formatCase(this.get(t,i,e,r),StringUtils_1.StringUtils.FORMAT_FIRST_UPPER_REST_LOWER)},t.prototype.parseJson=function(t){return JSON.parse(t)},t.prototype.parseProperties=function(t){for(var i={},e=new JavaPropertiesObject_1.JavaPropertiesObject(t),r=0,a=e.getKeys();r<a.length;r++){var n=a[r];i[n]=e.get(n)}return i},t}();exports.LocalizationManager=LocalizationManager;"]},"metadata":{},"sourceType":"script"}