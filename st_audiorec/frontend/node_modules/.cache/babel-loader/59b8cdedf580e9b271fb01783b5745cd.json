{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: !0\n});\n\nvar StringUtils_1 = require(\"../utils/StringUtils\"),\n    ObjectUtils_1 = require(\"../utils/ObjectUtils\"),\n    ArrayUtils_1 = require(\"../utils/ArrayUtils\"),\n    HashMapObject_1 = require(\"../model/HashMapObject\"),\n    HTTPManagerGetRequest_1 = require(\"./httpmanager/HTTPManagerGetRequest\"),\n    HTTPManagerBaseRequest_1 = require(\"./httpmanager/HTTPManagerBaseRequest\"),\n    HTTPManager = function () {\n  function t(t) {\n    if (void 0 === t && (t = !0), this.baseUrl = \"\", this.asynchronous = !0, this.timeout = 0, this.isOnlyHttps = !0, this.internetCheckLocations = [\"https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js\", \"https://ajax.aspnetcdn.com/ajax/modernizr/modernizr-2.8.3.js\", \"https://code.jquery.com/jquery-3.2.1.slim.min.js\"], this._queues = [], this._globalPostParams = {}, \"boolean\" != typeof t) throw new Error(\"asynchronous is not boolean\");\n    this.asynchronous = t;\n  }\n\n  return t.prototype.setGlobalPostParam = function (t, e) {\n    if (StringUtils_1.StringUtils.isEmpty(t) || StringUtils_1.StringUtils.isEmpty(e)) throw new Error(\"parameterName and value must be non empty strings\");\n    this._globalPostParams[t] = e;\n  }, t.prototype.isGlobalPostParam = function (t) {\n    if (StringUtils_1.StringUtils.isEmpty(t)) throw new Error(\"parameterName must be a non empty string\");\n    return Object.keys(this._globalPostParams).indexOf(t) >= 0;\n  }, t.prototype.getGlobalPostParam = function (t) {\n    if (!this.isGlobalPostParam(t)) throw new Error(\"parameterName does not exist: \" + t);\n    return this._globalPostParams[t];\n  }, t.prototype.deleteGlobalPostParam = function (t) {\n    \"\" !== this.getGlobalPostParam(t) && delete this._globalPostParams[t];\n  }, t.prototype.createQueue = function (t) {\n    if (StringUtils_1.StringUtils.isEmpty(t)) throw new Error(\"name must be a non empty string\");\n\n    for (var e = 0, r = this._queues; e < r.length; e++) {\n      if (r[e].name === t) throw new Error(\"queue \" + t + \" already exists\");\n    }\n\n    this._queues.push({\n      name: t,\n      isRunning: !1,\n      pendingRequests: []\n    });\n  }, t.prototype.countQueues = function () {\n    return this._queues.length;\n  }, t.prototype.isQueueRunning = function (t) {\n    if (StringUtils_1.StringUtils.isEmpty(t)) throw new Error(\"name must be a non empty string\");\n\n    for (var e = 0, r = this._queues; e < r.length; e++) {\n      var n = r[e];\n      if (n.name === t) return n.isRunning;\n    }\n\n    throw new Error(\"queue \" + t + \" does not exist\");\n  }, t.prototype.deleteQueue = function (t) {\n    if (StringUtils_1.StringUtils.isEmpty(t)) throw new Error(\"name must be a non empty string\");\n\n    for (var e = 0; e < this._queues.length; e++) {\n      if (this._queues[e].name === t) {\n        if (this._queues[e].isRunning) throw new Error(\"queue \" + t + \" is currently running\");\n        return void this._queues.splice(e, 1);\n      }\n    }\n\n    throw new Error(\"queue \" + t + \" does not exist\");\n  }, t.prototype.generateUrlQueryString = function (t) {\n    var e = \"\",\n        r = [],\n        n = [];\n\n    if (ObjectUtils_1.ObjectUtils.isObject(t) && ObjectUtils_1.ObjectUtils.getKeys(t).length > 0) {\n      if (t instanceof HashMapObject_1.HashMapObject) r = t.getKeys(), n = t.getValues();else {\n        r = Object.getOwnPropertyNames(t);\n\n        for (var s = 0; s < r.length; s++) {\n          n.push(t[r[s]]);\n        }\n      }\n\n      for (s = 0; s < r.length; s++) {\n        e += \"&\" + encodeURIComponent(r[s]) + \"=\" + encodeURIComponent(StringUtils_1.StringUtils.isString(n[s]) ? n[s] : JSON.stringify(n[s]));\n      }\n\n      return e.substring(1, e.length);\n    }\n\n    throw new Error(\"keyValuePairs must be a HashMapObject or a non empty Object\");\n  }, t.prototype.isInternetAvailable = function (t, e) {\n    var r = this;\n    if (\"function\" != typeof t || \"function\" != typeof e) throw new Error(\"params must be functions\");\n    if (this.internetCheckLocations.length <= 0) throw new Error(\"no check locations specified\");\n\n    var n = function n(s) {\n      if (s.length <= 0) return e();\n      var i = s.shift();\n      if (!StringUtils_1.StringUtils.isUrl(i)) throw new Error(\"invalid check url : \" + i);\n      r.urlExists(String(i + \"?r=\" + StringUtils_1.StringUtils.generateRandom(15, 15)), t, function () {\n        return n(s);\n      });\n    };\n\n    !1 === navigator.onLine ? e() : n(this.internetCheckLocations.slice(0));\n  }, t.prototype.urlExists = function (t, e, r) {\n    if (!StringUtils_1.StringUtils.isString(t)) throw new Error(\"url must be a string\");\n    if (\"function\" != typeof e || \"function\" != typeof r) throw new Error(\"params must be functions\");\n\n    var n = this._composeUrl(this.baseUrl, t);\n\n    if (StringUtils_1.StringUtils.isUrl(n)) {\n      var s = new HTTPManagerGetRequest_1.HTTPManagerGetRequest(n);\n      s.successCallback = function () {\n        return e();\n      }, s.errorCallback = function () {\n        return r();\n      }, this.execute(s);\n    } else r();\n  }, t.prototype.getUrlHeaders = function (e, r, n) {\n    var s = this,\n        i = this._composeUrl(this.baseUrl, e);\n\n    if (!StringUtils_1.StringUtils.isString(i)) throw new Error(\"url must be a string\");\n    if (\"function\" != typeof r || \"function\" != typeof n) throw new Error(\"params must be functions\");\n    if (!StringUtils_1.StringUtils.isUrl(i)) throw new Error(\"invalid url \" + i);\n    var o = new XMLHttpRequest();\n    this.timeout > 0 && (o.timeout = this.timeout), o.open(\"GET\", i, this.asynchronous), o.onload = function () {\n      return r(o.getAllResponseHeaders().split(\"\\n\"));\n    }, o.onerror = function () {\n      return n(o.statusText, o.status);\n    }, o.ontimeout = function () {\n      return n(s.timeout + t.ERROR_TIMEOUT, 408);\n    }, this._executeXmlHttprequestSend(o, i);\n  }, t.prototype.execute = function (e, r, n) {\n    var s = this;\n    void 0 === r && (r = null), void 0 === n && (n = null);\n\n    var i = this._generateValidRequestsList(e);\n\n    if (null !== r && !(r instanceof Function) || null !== n && !(n instanceof Function)) throw new Error(\"finishedCallback and progressCallback must be functions\");\n\n    for (var o = 0, a = !1, u = [], l = function l(t, e, _l, g, p) {\n      var c = t.request,\n          h = s._composeUrl(s.baseUrl, c.url),\n          f = e;\n\n      if (c.resultFormat === HTTPManagerBaseRequest_1.HTTPManagerBaseRequest.JSON) try {\n        f = JSON.parse(e);\n      } catch (t) {\n        _l || (_l = !0, g = \"Could not parse request result as a json string\");\n      }\n      o++, u[t.index] = {\n        url: h,\n        response: f,\n        isError: _l,\n        errorMsg: g,\n        code: p\n      }, _l ? (a = !0, c.errorCallback(g, p, e)) : c.successCallback(f), c.finallyCallback(), null !== n && n(h, i.length), o >= i.length && null !== r && r(u, a);\n    }, g = function g(e) {\n      var r,\n          n = {\n        index: e,\n        request: i[e]\n      };\n      if (!StringUtils_1.StringUtils.isString(i[e].url) || StringUtils_1.StringUtils.isEmpty(i[e].url)) throw new Error(\"url \" + e + \" must be a non empty string\");\n\n      try {\n        r = new XMLHttpRequest();\n      } catch (t) {\n        throw new Error(\"Could not initialize XMLHttpRequest. If running node, it is not natively available. We recommend npm xhr2 library that emulates XMLHttpRequest on node apps (global.XMLHttpRequest = require('xhr2'))\");\n      }\n\n      (i[e].timeout > 0 || p.timeout > 0) && (r.timeout = i[e].timeout > 0 ? i[e].timeout : p.timeout);\n\n      var o = p._composeUrl(p.baseUrl, i[e].url),\n          a = i[e] instanceof HTTPManagerGetRequest_1.HTTPManagerGetRequest ? \"GET\" : \"POST\";\n\n      if (r.open(a, o, p.asynchronous), r.onload = function () {\n        r.status >= 200 && r.status < 400 ? l(n, r.responseText, !1, \"\", r.status) : l(n, r.responseText, !0, r.statusText, r.status);\n      }, r.onerror = function () {\n        l(n, r.responseText, !0, r.statusText, r.status);\n      }, r.ontimeout = function () {\n        l(n, r.responseText, !0, s.timeout + t.ERROR_TIMEOUT, 408);\n      }, \"GET\" === a && p._executeXmlHttprequestSend(r, o), \"POST\" === a || Object.keys(p._globalPostParams).length > 0) try {\n        var u = \"POST\" === a ? i[e].parameters : {};\n        if (!1 === i[e].ignoreGlobalPostParams) for (var g = 0, c = Object.keys(p._globalPostParams); g < c.length; g++) {\n          var h = c[g];\n          u instanceof HashMapObject_1.HashMapObject ? u.set(h, p._globalPostParams[h]) : u[h] = p._globalPostParams[h];\n        }\n        r.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\"), r.send(p.generateUrlQueryString(u));\n      } catch (t) {\n        p._executeXmlHttprequestSend(r, o);\n      }\n    }, p = this, c = 0; c < i.length; c++) {\n      g(c);\n    }\n  }, t.prototype._executeXmlHttprequestSend = function (t, e) {\n    try {\n      t.send();\n    } catch (t) {\n      throw new Error(\"HTTPManager could not execute request to \" + e + \"\\n\" + t.toString());\n    }\n  }, t.prototype._generateValidRequestsList = function (t) {\n    var e = [];\n\n    if (ArrayUtils_1.ArrayUtils.isArray(t)) {\n      if (t.length <= 0) throw new Error(\"No requests to execute\");\n\n      for (var r = 0, n = t; r < n.length; r++) {\n        var s = n[r];\n        StringUtils_1.StringUtils.isString(s) ? e.push(new HTTPManagerGetRequest_1.HTTPManagerGetRequest(s)) : e.push(s);\n      }\n    } else if (StringUtils_1.StringUtils.isString(t) && !StringUtils_1.StringUtils.isEmpty(t)) e = [new HTTPManagerGetRequest_1.HTTPManagerGetRequest(t)];else {\n      if (!(t instanceof HTTPManagerBaseRequest_1.HTTPManagerBaseRequest)) throw new Error(\"Invalid requests value\");\n      e = [t];\n    }\n\n    return e;\n  }, t.prototype.queue = function (t, e, r) {\n    void 0 === r && (r = null);\n\n    var n = this._generateValidRequestsList(t);\n\n    if (null !== r && !(r instanceof Function)) throw new Error(\"finishedCallback and progressCallback must be functions\");\n\n    for (var s = 0, i = this._queues; s < i.length; s++) {\n      var o = i[s];\n\n      if (o.name === e) {\n        for (var a = 0; a < n.length; a++) {\n          o.pendingRequests.unshift(n[a]);\n        }\n\n        if (null !== r) {\n          var u = new HTTPManagerGetRequest_1.HTTPManagerGetRequest(\"FINISHED_REQUEST_CALLBACK\");\n          u.finallyCallback = r, o.pendingRequests.unshift(u);\n        }\n\n        return void (this.isQueueRunning(e) || this._startQueue(e));\n      }\n    }\n\n    throw new Error(\"queue \" + e + \" does not exist. Create it with createQueue()\");\n  }, t.prototype._startQueue = function (t) {\n    for (var e = this, r = function r(t) {\n      if (t.pendingRequests.length <= 0) t.isRunning = !1;else {\n        if (\"FINISHED_REQUEST_CALLBACK\" === t.pendingRequests[t.pendingRequests.length - 1].url) {\n          var n = t.pendingRequests.pop();\n          t.pendingRequests.length <= 0 && (t.isRunning = !1), n.finallyCallback();\n        }\n\n        t.pendingRequests.length > 0 && (t.isRunning = !0, e.execute(t.pendingRequests.pop(), function () {\n          return r(t);\n        }));\n      }\n    }, n = 0, s = this._queues; n < s.length; n++) {\n      var i = s[n];\n      if (i.name === t) return void r(i);\n    }\n  }, t.prototype.loadResourcesFromList = function (t, e, r, n, s) {\n    var i = this;\n    if (void 0 === s && (s = null), !StringUtils_1.StringUtils.isString(t) || StringUtils_1.StringUtils.isEmpty(t)) throw new Error(\"urlToListOfResources must be a non empty string\");\n    if (!StringUtils_1.StringUtils.isString(e) || StringUtils_1.StringUtils.isEmpty(e)) throw new Error(\"baseUrl must be a non empty string\");\n    this.execute(t, function (o, a) {\n      if (o[0].isError) return n(t, o[0].errorMsg, o[0].code);\n\n      for (var u = [], l = StringUtils_1.StringUtils.getLines(o[0].response), g = 0, p = l; g < p.length; g++) {\n        var c = p[g];\n        u.push(StringUtils_1.StringUtils.formatPath(i._composeUrl(e, c), \"/\"));\n      }\n\n      i.execute(u, function (t, e) {\n        for (var s = [], i = 0, o = t; i < o.length; i++) {\n          var a = o[i];\n          if (a.isError) return n(a.url, a.errorMsg, a.code);\n          s.push(a.response);\n        }\n\n        r(l, s);\n      }, s);\n    });\n  }, t.prototype._composeUrl = function (t, e) {\n    var r = \"\";\n    if (r = StringUtils_1.StringUtils.isEmpty(t) || \"http:\" === e.substr(0, 5) || \"https:\" === e.substr(0, 6) ? e : StringUtils_1.StringUtils.replace(StringUtils_1.StringUtils.formatPath(t + \"/\" + e, \"/\"), [\"http:/\", \"https:/\"], [\"http://\", \"https://\"], 1), this.isOnlyHttps && \"http:\" === r.substr(0, 5).toLowerCase()) throw new Error(\"Non secure http requests are forbidden. Set isOnlyHttps=false to allow \" + r);\n    return r;\n  }, t.ERROR_TIMEOUT = \" ms Timeout reached\", t;\n}();\n\nexports.HTTPManager = HTTPManager;","map":{"version":3,"sources":["/Users/stefan_rmmr/software_dev/beat_inspector/st_audiorec/frontend/node_modules/turbocommons-ts/managers/HTTPManager.js"],"names":["Object","defineProperty","exports","value","StringUtils_1","require","ObjectUtils_1","ArrayUtils_1","HashMapObject_1","HTTPManagerGetRequest_1","HTTPManagerBaseRequest_1","HTTPManager","t","baseUrl","asynchronous","timeout","isOnlyHttps","internetCheckLocations","_queues","_globalPostParams","Error","prototype","setGlobalPostParam","e","StringUtils","isEmpty","isGlobalPostParam","keys","indexOf","getGlobalPostParam","deleteGlobalPostParam","createQueue","r","length","name","push","isRunning","pendingRequests","countQueues","isQueueRunning","n","deleteQueue","splice","generateUrlQueryString","ObjectUtils","isObject","getKeys","HashMapObject","getValues","getOwnPropertyNames","s","encodeURIComponent","isString","JSON","stringify","substring","isInternetAvailable","i","shift","isUrl","urlExists","String","generateRandom","navigator","onLine","slice","_composeUrl","HTTPManagerGetRequest","successCallback","errorCallback","execute","getUrlHeaders","o","XMLHttpRequest","open","onload","getAllResponseHeaders","split","onerror","statusText","status","ontimeout","ERROR_TIMEOUT","_executeXmlHttprequestSend","_generateValidRequestsList","Function","a","u","l","g","p","c","request","h","url","f","resultFormat","HTTPManagerBaseRequest","parse","index","response","isError","errorMsg","code","finallyCallback","responseText","parameters","ignoreGlobalPostParams","set","setRequestHeader","send","toString","ArrayUtils","isArray","queue","unshift","_startQueue","pop","loadResourcesFromList","getLines","formatPath","substr","replace","toLowerCase"],"mappings":"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","sourcesContent":["\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var StringUtils_1=require(\"../utils/StringUtils\"),ObjectUtils_1=require(\"../utils/ObjectUtils\"),ArrayUtils_1=require(\"../utils/ArrayUtils\"),HashMapObject_1=require(\"../model/HashMapObject\"),HTTPManagerGetRequest_1=require(\"./httpmanager/HTTPManagerGetRequest\"),HTTPManagerBaseRequest_1=require(\"./httpmanager/HTTPManagerBaseRequest\"),HTTPManager=function(){function t(t){if(void 0===t&&(t=!0),this.baseUrl=\"\",this.asynchronous=!0,this.timeout=0,this.isOnlyHttps=!0,this.internetCheckLocations=[\"https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js\",\"https://ajax.aspnetcdn.com/ajax/modernizr/modernizr-2.8.3.js\",\"https://code.jquery.com/jquery-3.2.1.slim.min.js\"],this._queues=[],this._globalPostParams={},\"boolean\"!=typeof t)throw new Error(\"asynchronous is not boolean\");this.asynchronous=t}return t.prototype.setGlobalPostParam=function(t,e){if(StringUtils_1.StringUtils.isEmpty(t)||StringUtils_1.StringUtils.isEmpty(e))throw new Error(\"parameterName and value must be non empty strings\");this._globalPostParams[t]=e},t.prototype.isGlobalPostParam=function(t){if(StringUtils_1.StringUtils.isEmpty(t))throw new Error(\"parameterName must be a non empty string\");return Object.keys(this._globalPostParams).indexOf(t)>=0},t.prototype.getGlobalPostParam=function(t){if(!this.isGlobalPostParam(t))throw new Error(\"parameterName does not exist: \"+t);return this._globalPostParams[t]},t.prototype.deleteGlobalPostParam=function(t){\"\"!==this.getGlobalPostParam(t)&&delete this._globalPostParams[t]},t.prototype.createQueue=function(t){if(StringUtils_1.StringUtils.isEmpty(t))throw new Error(\"name must be a non empty string\");for(var e=0,r=this._queues;e<r.length;e++){if(r[e].name===t)throw new Error(\"queue \"+t+\" already exists\")}this._queues.push({name:t,isRunning:!1,pendingRequests:[]})},t.prototype.countQueues=function(){return this._queues.length},t.prototype.isQueueRunning=function(t){if(StringUtils_1.StringUtils.isEmpty(t))throw new Error(\"name must be a non empty string\");for(var e=0,r=this._queues;e<r.length;e++){var n=r[e];if(n.name===t)return n.isRunning}throw new Error(\"queue \"+t+\" does not exist\")},t.prototype.deleteQueue=function(t){if(StringUtils_1.StringUtils.isEmpty(t))throw new Error(\"name must be a non empty string\");for(var e=0;e<this._queues.length;e++)if(this._queues[e].name===t){if(this._queues[e].isRunning)throw new Error(\"queue \"+t+\" is currently running\");return void this._queues.splice(e,1)}throw new Error(\"queue \"+t+\" does not exist\")},t.prototype.generateUrlQueryString=function(t){var e=\"\",r=[],n=[];if(ObjectUtils_1.ObjectUtils.isObject(t)&&ObjectUtils_1.ObjectUtils.getKeys(t).length>0){if(t instanceof HashMapObject_1.HashMapObject)r=t.getKeys(),n=t.getValues();else{r=Object.getOwnPropertyNames(t);for(var s=0;s<r.length;s++)n.push(t[r[s]])}for(s=0;s<r.length;s++)e+=\"&\"+encodeURIComponent(r[s])+\"=\"+encodeURIComponent(StringUtils_1.StringUtils.isString(n[s])?n[s]:JSON.stringify(n[s]));return e.substring(1,e.length)}throw new Error(\"keyValuePairs must be a HashMapObject or a non empty Object\")},t.prototype.isInternetAvailable=function(t,e){var r=this;if(\"function\"!=typeof t||\"function\"!=typeof e)throw new Error(\"params must be functions\");if(this.internetCheckLocations.length<=0)throw new Error(\"no check locations specified\");var n=function(s){if(s.length<=0)return e();var i=s.shift();if(!StringUtils_1.StringUtils.isUrl(i))throw new Error(\"invalid check url : \"+i);r.urlExists(String(i+\"?r=\"+StringUtils_1.StringUtils.generateRandom(15,15)),t,function(){return n(s)})};!1===navigator.onLine?e():n(this.internetCheckLocations.slice(0))},t.prototype.urlExists=function(t,e,r){if(!StringUtils_1.StringUtils.isString(t))throw new Error(\"url must be a string\");if(\"function\"!=typeof e||\"function\"!=typeof r)throw new Error(\"params must be functions\");var n=this._composeUrl(this.baseUrl,t);if(StringUtils_1.StringUtils.isUrl(n)){var s=new HTTPManagerGetRequest_1.HTTPManagerGetRequest(n);s.successCallback=function(){return e()},s.errorCallback=function(){return r()},this.execute(s)}else r()},t.prototype.getUrlHeaders=function(e,r,n){var s=this,i=this._composeUrl(this.baseUrl,e);if(!StringUtils_1.StringUtils.isString(i))throw new Error(\"url must be a string\");if(\"function\"!=typeof r||\"function\"!=typeof n)throw new Error(\"params must be functions\");if(!StringUtils_1.StringUtils.isUrl(i))throw new Error(\"invalid url \"+i);var o=new XMLHttpRequest;this.timeout>0&&(o.timeout=this.timeout),o.open(\"GET\",i,this.asynchronous),o.onload=function(){return r(o.getAllResponseHeaders().split(\"\\n\"))},o.onerror=function(){return n(o.statusText,o.status)},o.ontimeout=function(){return n(s.timeout+t.ERROR_TIMEOUT,408)},this._executeXmlHttprequestSend(o,i)},t.prototype.execute=function(e,r,n){var s=this;void 0===r&&(r=null),void 0===n&&(n=null);var i=this._generateValidRequestsList(e);if(null!==r&&!(r instanceof Function)||null!==n&&!(n instanceof Function))throw new Error(\"finishedCallback and progressCallback must be functions\");for(var o=0,a=!1,u=[],l=function(t,e,l,g,p){var c=t.request,h=s._composeUrl(s.baseUrl,c.url),f=e;if(c.resultFormat===HTTPManagerBaseRequest_1.HTTPManagerBaseRequest.JSON)try{f=JSON.parse(e)}catch(t){l||(l=!0,g=\"Could not parse request result as a json string\")}o++,u[t.index]={url:h,response:f,isError:l,errorMsg:g,code:p},l?(a=!0,c.errorCallback(g,p,e)):c.successCallback(f),c.finallyCallback(),null!==n&&n(h,i.length),o>=i.length&&null!==r&&r(u,a)},g=function(e){var r,n={index:e,request:i[e]};if(!StringUtils_1.StringUtils.isString(i[e].url)||StringUtils_1.StringUtils.isEmpty(i[e].url))throw new Error(\"url \"+e+\" must be a non empty string\");try{r=new XMLHttpRequest}catch(t){throw new Error(\"Could not initialize XMLHttpRequest. If running node, it is not natively available. We recommend npm xhr2 library that emulates XMLHttpRequest on node apps (global.XMLHttpRequest = require('xhr2'))\")}(i[e].timeout>0||p.timeout>0)&&(r.timeout=i[e].timeout>0?i[e].timeout:p.timeout);var o=p._composeUrl(p.baseUrl,i[e].url),a=i[e]instanceof HTTPManagerGetRequest_1.HTTPManagerGetRequest?\"GET\":\"POST\";if(r.open(a,o,p.asynchronous),r.onload=function(){r.status>=200&&r.status<400?l(n,r.responseText,!1,\"\",r.status):l(n,r.responseText,!0,r.statusText,r.status)},r.onerror=function(){l(n,r.responseText,!0,r.statusText,r.status)},r.ontimeout=function(){l(n,r.responseText,!0,s.timeout+t.ERROR_TIMEOUT,408)},\"GET\"===a&&p._executeXmlHttprequestSend(r,o),\"POST\"===a||Object.keys(p._globalPostParams).length>0)try{var u=\"POST\"===a?i[e].parameters:{};if(!1===i[e].ignoreGlobalPostParams)for(var g=0,c=Object.keys(p._globalPostParams);g<c.length;g++){var h=c[g];u instanceof HashMapObject_1.HashMapObject?u.set(h,p._globalPostParams[h]):u[h]=p._globalPostParams[h]}r.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\"),r.send(p.generateUrlQueryString(u))}catch(t){p._executeXmlHttprequestSend(r,o)}},p=this,c=0;c<i.length;c++)g(c)},t.prototype._executeXmlHttprequestSend=function(t,e){try{t.send()}catch(t){throw new Error(\"HTTPManager could not execute request to \"+e+\"\\n\"+t.toString())}},t.prototype._generateValidRequestsList=function(t){var e=[];if(ArrayUtils_1.ArrayUtils.isArray(t)){if(t.length<=0)throw new Error(\"No requests to execute\");for(var r=0,n=t;r<n.length;r++){var s=n[r];StringUtils_1.StringUtils.isString(s)?e.push(new HTTPManagerGetRequest_1.HTTPManagerGetRequest(s)):e.push(s)}}else if(StringUtils_1.StringUtils.isString(t)&&!StringUtils_1.StringUtils.isEmpty(t))e=[new HTTPManagerGetRequest_1.HTTPManagerGetRequest(t)];else{if(!(t instanceof HTTPManagerBaseRequest_1.HTTPManagerBaseRequest))throw new Error(\"Invalid requests value\");e=[t]}return e},t.prototype.queue=function(t,e,r){void 0===r&&(r=null);var n=this._generateValidRequestsList(t);if(null!==r&&!(r instanceof Function))throw new Error(\"finishedCallback and progressCallback must be functions\");for(var s=0,i=this._queues;s<i.length;s++){var o=i[s];if(o.name===e){for(var a=0;a<n.length;a++)o.pendingRequests.unshift(n[a]);if(null!==r){var u=new HTTPManagerGetRequest_1.HTTPManagerGetRequest(\"FINISHED_REQUEST_CALLBACK\");u.finallyCallback=r,o.pendingRequests.unshift(u)}return void(this.isQueueRunning(e)||this._startQueue(e))}}throw new Error(\"queue \"+e+\" does not exist. Create it with createQueue()\")},t.prototype._startQueue=function(t){for(var e=this,r=function(t){if(t.pendingRequests.length<=0)t.isRunning=!1;else{if(\"FINISHED_REQUEST_CALLBACK\"===t.pendingRequests[t.pendingRequests.length-1].url){var n=t.pendingRequests.pop();t.pendingRequests.length<=0&&(t.isRunning=!1),n.finallyCallback()}t.pendingRequests.length>0&&(t.isRunning=!0,e.execute(t.pendingRequests.pop(),function(){return r(t)}))}},n=0,s=this._queues;n<s.length;n++){var i=s[n];if(i.name===t)return void r(i)}},t.prototype.loadResourcesFromList=function(t,e,r,n,s){var i=this;if(void 0===s&&(s=null),!StringUtils_1.StringUtils.isString(t)||StringUtils_1.StringUtils.isEmpty(t))throw new Error(\"urlToListOfResources must be a non empty string\");if(!StringUtils_1.StringUtils.isString(e)||StringUtils_1.StringUtils.isEmpty(e))throw new Error(\"baseUrl must be a non empty string\");this.execute(t,function(o,a){if(o[0].isError)return n(t,o[0].errorMsg,o[0].code);for(var u=[],l=StringUtils_1.StringUtils.getLines(o[0].response),g=0,p=l;g<p.length;g++){var c=p[g];u.push(StringUtils_1.StringUtils.formatPath(i._composeUrl(e,c),\"/\"))}i.execute(u,function(t,e){for(var s=[],i=0,o=t;i<o.length;i++){var a=o[i];if(a.isError)return n(a.url,a.errorMsg,a.code);s.push(a.response)}r(l,s)},s)})},t.prototype._composeUrl=function(t,e){var r=\"\";if(r=StringUtils_1.StringUtils.isEmpty(t)||\"http:\"===e.substr(0,5)||\"https:\"===e.substr(0,6)?e:StringUtils_1.StringUtils.replace(StringUtils_1.StringUtils.formatPath(t+\"/\"+e,\"/\"),[\"http:/\",\"https:/\"],[\"http://\",\"https://\"],1),this.isOnlyHttps&&\"http:\"===r.substr(0,5).toLowerCase())throw new Error(\"Non secure http requests are forbidden. Set isOnlyHttps=false to allow \"+r);return r},t.ERROR_TIMEOUT=\" ms Timeout reached\",t}();exports.HTTPManager=HTTPManager;"]},"metadata":{},"sourceType":"script"}